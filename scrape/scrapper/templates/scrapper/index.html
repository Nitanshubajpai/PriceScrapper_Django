<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

    <title>Scrapper</title>
</head>
<style>
    .card{
        background-color: white;
    }
    .row{
        margin: 20px auto;
    }
    h5{
        margin: 10px 20px;
    }
</style>
<body class="container">
    <div class="row">
        <div class="col-6">
            <div class="card">        
                <div class="card">        
                <div id="chart-development-activity1"></div>
                <h5 id="name1"></h5>
            </div>
            </div>
        </div>
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity2"></div>
                <h5 id="name2"></h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity3"></div>
                <h5 id="name3"></h5>
            </div>
        </div>
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity4"></div>
                <h5 id="name4"></h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity5"></div>
                <h5 id="name5"></h5>
            </div>
        </div>
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity6"></div>
                <h5 id="name6"></h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity7"></div>
                <h5 id="name7"></h5>
            </div>
        </div>
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity8"></div>
                <h5 id="name8"></h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity9"></div>
                <h5 id="name9"></h5>
            </div>
        </div>
        <div class="col-6">
            <div class="card">        
                <div id="chart-development-activity10"></div>
                <h5 id="name10"></h5>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(function() {
      // This function gets cookie with a given name
      function getCookie(name) {
          var cookieValue = null;
          if (document.cookie && document.cookie != '') {
              var cookies = document.cookie.split(';');
              for (var i = 0; i < cookies.length; i++) {
                  var cookie = jQuery.trim(cookies[i]);
                  // Does this cookie string begin with the name we want?
                  if (cookie.substring(0, name.length + 1) == (name + '=')) {
                      cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                      break;
                  }
              }
          }
          return cookieValue;
      }
      var csrftoken = getCookie('csrftoken');
      /*
      The functions below will create a header with csrftoken
      */
      function csrfSafeMethod(method) {
          // these HTTP methods do not require CSRF protection
          return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
      }
      function sameOrigin(url) {
          // test that a given url is a same-origin URL
          // url could be relative or scheme relative or absolute
          var host = document.location.host; // host + port
          var protocol = document.location.protocol;
          var sr_origin = '//' + host;
          var origin = protocol + sr_origin;
          // Allow absolute or scheme relative URLs to same origin
          return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
              (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
              // or any other URL that isn't scheme relative or absolute i.e relative.
              !(/^(\/\/|http:|https:).*/.test(url));
      }
      $.ajaxSetup({
          beforeSend: function(xhr, settings) {
              if (!csrfSafeMethod(settings.type) && sameOrigin(settings.url)) {
                  // Send the token to same-origin, relative URLs only.
                  // Send the token only if the method warrants CSRF protection
                  // Using the CSRFToken value acquired earlier
                  xhr.setRequestHeader("X-CSRFToken", csrftoken);
              }
          }
      });
  });
      </script>
    <script>
        var p=[];
        var t=[];
        for(let i=0; i<10; i++){
            p[i]=[];
            p[i][0]=[];
            p[i][1]=[];
            p[i][2]=[];
            p[i][3]=[];
        }


        function plot(p) {
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity1'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[0][0]
                },
            {
                    name: "FlipKart",
                    data: p[0][1]
                },
            {
                    name: "PaytmMall",
                    data: p[0][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[0][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();

            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity2'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[1][0]
                },
            {
                    name: "FlipKart",
                    data: p[1][1]
                },
            {
                    name: "PaytmMall",
                    data: p[1][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[1][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity3'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[2][0]
                },
            {
                    name: "FlipKart",
                    data: p[2][1]
                },
            {
                    name: "PaytmMall",
                    data: p[2][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[2][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity4'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[3][0]
                },
            {
                    name: "FlipKart",
                    data: p[3][1]
                },
            {
                    name: "PaytmMall",
                    data: p[3][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[3][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity5'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: true
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[4][0]
                },
            {
                    name: "FlipKart",
                    data: p[4][1]
                },
            {
                    name: "PaytmMall",
                    data: p[4][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[4][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                    colors: ["white"],
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity6'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[5][0]
                },
            {
                    name: "FlipKart",
                    data: p[5][1]
                },
            {
                    name: "PaytmMall",
                    data: p[5][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[5][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity7'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[6][0]
                },
            {
                    name: "FlipKart",
                    data: p[6][1]
                },
            {
                    name: "PaytmMall",
                    data: p[6][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[6][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity8'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[7][0]
                },
            {
                    name: "FlipKart",
                    data: p[7][1]
                },
            {
                    name: "PaytmMall",
                    data: p[7][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[7][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity9'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[8][0]
                },
            {
                    name: "FlipKart",
                    data: p[8][1]
                },
            {
                    name: "PaytmMall",
                    data: p[8][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[8][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
            window.ApexCharts && (new ApexCharts(document.getElementById('chart-development-activity10'), {
                chart: {
                    type: "line",
                    fontFamily: 'inherit',
                    height: 192,
                    sparkline: {
                        enabled: false
                    },
                    animations: {
                        enabled: false
                    },
                },
                dataLabels: {
                    enabled: false,
                },
                fill: {
                    opacity: 1,
                    type: 'solid'
                },
                stroke: {
                    width: 2,
                    lineCap: "round",
                    curve: "smooth",
                },
                series: [{
                    name: "Amazon",
                    data:  p[9][0]
                },
            {
                    name: "FlipKart",
                    data: p[9][1]
                },
            {
                    name: "PaytmMall",
                    data: p[9][2]
                },
            {
              
                    name: "VijaySales",
                    data: p[9][3]
                }],
                grid: {
                    strokeDashArray: 4,
                },
                xaxis: {
                    labels: {
                        padding:4
                    },
                    tooltip: {
                        enabled: false
                    },
                    axisBorder: {
                        show: true,
                    },
                    type: 'time',
                },
                yaxis: {
                    labels: {
                        padding: 4
                    },
                },
                labels: [
                    '12:00', '12:02','12:04', '12:06','12:08', '12:10','12:12', '12:14'   
                ],
                colors: ['#F44336', '#E91E63', '#9C27B0', '#1C97B0'],
                legend: {
                    show: true,
                },
                point: {
                    show: true
                },
            })).render();
        }
        
        
        $(document).on('DOMContentLoaded', setInterval(function(e){
                  $.ajax({
                      method: 'POST',
                      url: "{% url 'index' %}",
                      data: {
                        csrfmiddlewaretoken: '{{ csrf_token }}',
                        action: 'get',
                      },
                      success:function(){
                        var info = {{ price | safe}};
                        for(i=0; i<10; i++){

                            p[i][0].push(info.info[i]['amazon']);
                            p[i][1].push(info.info[i]['flipkart']);
                            p[i][2].push(info.info[i]['paytm']);
                            p[i][3].push(info.info[i]['vijay']);
                        }
                        document.getElementById("name1").innerHTML = info.info[0]['name'];
                        document.getElementById("name2").innerHTML = info.info[1]['name'];
                        document.getElementById("name3").innerHTML = info.info[2]['name'];
                        document.getElementById("name4").innerHTML = info.info[3]['name'];
                        document.getElementById("name5").innerHTML = info.info[4]['name'];
                        document.getElementById("name6").innerHTML = info.info[5]['name'];
                        document.getElementById("name7").innerHTML = info.info[6]['name'];
                        document.getElementById("name8").innerHTML = info.info[7]['name'];
                        document.getElementById("name9").innerHTML = info.info[8]['name'];
                        document.getElementById("name10").innerHTML = info.info[9]['name'];
                        plot(p)
                      },
                    });
                 }, 30000));
            
      </script>
</body>

</html>